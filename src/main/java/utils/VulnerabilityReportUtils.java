package utils;

import org.apache.poi.EncryptedDocumentException;
import valueobjects.RowIndex;
import valueobjects.VRow;

import java.io.IOException;
import java.util.ArrayList;
import java.util.List;
import java.util.Map;
import java.util.stream.Stream;
import java.util.Arrays;

/**
 * Created by tsomal on 2/23/21.
 */
public class VulnerabilityReportUtils {

    public static void main(String args[]) throws EncryptedDocumentException, IOException {
        extractMyVulnerabilities("MasterMapping.xlsx", "Tarun");

    }

    public static void extractMyVulnerabilities(String vulnerabilityReport, String productOwner) {
        List<VRow> allMappingRows = ExcelReaderUtil.getAllRowsFromMasterMapper("MasterMapping.xlsx", "MASTER", productOwner);

//        for (VRow r : allMappingRows) {
//            System.out.println("Server Name# "+ r.getServerId() + " Service Name# " + r.getServiceName() +"\n");
//        }


        List<VRow> alVulnerabilitiesRows = ExcelReaderUtil.getAllRowsFromVulnerabilityReport("Vulnerabilities.xlsx", productOwner);

        for (VRow r : alVulnerabilitiesRows) {
            System.out.println(r);
        }
    }




}
